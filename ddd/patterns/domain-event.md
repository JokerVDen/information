## Доменное событие (Domain Event)

Доменное событие - это событие, которое отражает значимое происшествие или изменение в предметной области вашего
приложения. Оно обычно представляет собой что-то важное, что происходит в контексте вашей бизнес-логики или доменной
модели.

### Ключевые аспекты доменных событий:

- **Отражение доменной активности**: Доменные события отражают активность или изменения в предметной области вашего
  приложения. Например, событие "Пользователь зарегистрирован" или "Заказ создан" отражает ключевые действия в системе.

- **Неизменяемость и история**: Доменные события обычно неизменяемы и сохраняются в истории системы. Они представляют
  факт произошедшего события и не подлежат изменению. Это позволяет строить аудит и воспроизводить последовательность
  действий.

- **Использование в асинхронном стиле**: Доменные события могут быть использованы для построения асинхронной системы,
  где различные компоненты реагируют на события, генерируемые другими частями системы.

- **Интеграция и шина событий**: Доменные события часто используются в архитектуре на основе шины событий (Event Bus),
  где различные компоненты могут публиковать и подписываться на события для взаимодействия и интеграции.

- **Отражение бизнес-процессов**: Доменные события могут отражать бизнес-процессы и состояния, что позволяет лучше
  моделировать и понимать предметную область.

Применение доменных событий помогает создать гибкую, отслеживаемую и отдельно работающую систему, где различные
компоненты могут взаимодействовать и реагировать на изменения в предметной области. Они являются важной составляющей
многих архитектурных подходов, таких как Domain-Driven Design (DDD), CQRS и событийно-ориентированные архитектуры.

```php
<?php
// Абстрактный класс для всех событий домена
abstract class DomainEvent {
    protected $occurredAt;

    public function __construct() {
        $this->occurredAt = new DateTime();
    }

    public function occurredAt() {
        return $this->occurredAt;
    }
}

// Пример конкретного события домена
class UserRegistered extends DomainEvent {
    private $userId;
    private $email;

    public function __construct($userId, $email) {
        parent::__construct();
        $this->userId = $userId;
        $this->email = $email;
    }

    public function getUserId() {
        return $this->userId;
    }

    public function getEmail() {
        return $this->email;
    }
}

// Пример использования события домена
$userId = 123;
$email = 'example@example.com';

$event = new UserRegistered($userId, $email);

echo 'User registered event occurred at: ' . $event->occurredAt()->format('Y-m-d H:i:s');
echo "\n";
echo 'User ID: ' . $event->getUserId();
echo "\n";
echo 'Email: ' . $event->getEmail();
```

В этом примере `DomainEvent` является абстрактным классом, определяющим метод `occurredAt()`, который возвращает дату и
время события. Класс `UserRegistered` представляет конкретное событие домена, которое происходит при регистрации нового
пользователя. Каждый экземпляр события имеет время его возникновения (`occurredAt`), а также дополнительные данные,
такие как идентификатор пользователя и его электронная почта.

Этот пример демонстрирует основную идею паттерна "Событие домена", который позволяет отделить доменные события от
бизнес-логики и делает систему более гибкой и расширяемой.

[К паттернам DDD](main.md)

[На главную DDD](../main.md)